(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[149],{9573:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ProductDetails",function(){return i(6895)}])},1227:function(e,t,i){"use strict";i.d(t,{E:function(){return a}}),i(5893);var s=i(7294);let n=(0,s.createContext)({state:{items:[]},dispatch:()=>void 0}),a=()=>(0,s.useContext)(n)},6895:function(e,t,i){"use strict";i.r(t);var s=i(5893),n=i(7294),a=i(1163),r=i(5861),o=i(5616),l=i(6720),c=i(3946),d=i(1292),h=i(6653),m=i(6886),x=i(6242),u=i(5450),j=i(9007),p=i(1440),Z=i(9417),g=i(1903),y=i(7533),b=i(8462),v=i(891),k=i(9334),w=i(7720),f=i(5970),S=i(1737),C=i(1023),_=i(6540),E=i(4895),O=i(5500),A=i(1733),R=i(6111),T=i(1811),I=i(1712),P=i(1227),B=i(5675),F=i.n(B);t.default=()=>{let e=(0,a.useRouter)(),{id:t}=e.query,{state:i,dispatch:B}=(0,I.K)(),{state:q,dispatch:D}=(0,P.E)(),[N,M]=(0,n.useState)(null),[z,K]=(0,n.useState)({user:"",comment:"",rating:0}),[H,W]=(0,n.useState)(!1),[L,U]=(0,n.useState)(""),[V,$]=(0,n.useState)("success"),[X,Y]=(0,n.useState)(!1),[G,Q]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/products/".concat(t));if(!e.ok)throw Error("Failed to fetch product");let i=await e.json();M(i),Q(i.images[0])}catch(e){console.error(e)}};t&&e()},[t]);let J=e=>{e.inStock?(B({type:"ADD_TO_BASKET",product:e}),U("Added ".concat(e.name," to basket")),$("success")):(U("Sorry, ".concat(e.name," is out of stock.")),$("error")),W(!0)},ee=e=>{D({type:"ADD_TO_WISHLIST",product:e}),U("Added ".concat(e.name," to wishlist")),$("success"),W(!0)},et=e=>{D({type:"REMOVE_FROM_WISHLIST",id:e}),U("Removed item from wishlist"),$("success"),W(!0)},ei=(e,t)=>{K(i=>({...i,[e]:t}))},es=()=>{Y(!X)},en=(e,t)=>{t<=0?B({type:"REMOVE_FROM_BASKET",id:e}):B({type:"UPDATE_BASKET_QUANTITY",id:e,quantity:t})},ea=i.items.reduce((e,t)=>e+t.price*t.quantity,0);return N?(0,s.jsxs)(o.Z,{sx:{padding:{xs:"1rem",sm:"2rem"}},children:[(0,s.jsx)(l.ZP,{}),(0,s.jsxs)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,s.jsx)(c.Z,{onClick:()=>e.back(),"aria-label":"Go back",children:(0,s.jsx)(C.Z,{})}),(0,s.jsx)(d.Z,{title:"Open shopping basket",children:(0,s.jsx)(c.Z,{onClick:es,"aria-label":"Open shopping basket",children:(0,s.jsx)(h.Z,{badgeContent:i.items.reduce((e,t)=>e+t.quantity,0),color:"secondary",children:(0,s.jsx)(O.Z,{fontSize:"large"})})})})]}),(0,s.jsxs)(m.ZP,{container:!0,spacing:3,children:[(0,s.jsxs)(m.ZP,{item:!0,xs:12,md:6,children:[(0,s.jsx)(x.Z,{children:(0,s.jsx)(F(),{src:G,alt:N.name,width:600,height:400,objectFit:"cover",layout:"responsive"})}),(0,s.jsx)(u.Z,{cols:3,rowHeight:100,sx:{mt:2},children:N.images.map((e,t)=>(0,s.jsx)(j.Z,{onClick:()=>Q(e),sx:{cursor:"pointer"},children:(0,s.jsx)(F(),{src:e,alt:"Thumbnail ".concat(t),width:100,height:100,objectFit:"cover",sizes:"(max-width: 600px) 100px, (max-width: 960px) 100px, 100px",loading:"lazy","aria-hidden":"true"})},t))})]}),(0,s.jsxs)(m.ZP,{item:!0,xs:12,md:6,children:[(0,s.jsx)(r.Z,{variant:"h4",gutterBottom:!0,children:N.name}),(0,s.jsx)(p.Z,{name:"read-only",value:N.rating,readOnly:!0}),(0,s.jsxs)(r.Z,{variant:"h6",color:"primary",gutterBottom:!0,children:["$",N.price.toFixed(2)]}),(0,s.jsx)(r.Z,{variant:"body1",gutterBottom:!0,children:N.description}),(0,s.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,s.jsx)(Z.Z,{variant:"contained",color:"primary",endIcon:(0,s.jsx)(_.Z,{}),onClick:()=>J(N),disabled:!N.inStock,"aria-label":N.inStock?"Add to basket":"Out of stock",children:N.inStock?"Add to Basket":"Out of Stock"}),(0,s.jsx)(d.Z,{title:q.items.some(e=>e.id===N.id)?"Remove from wishlist":"Add to wishlist",children:(0,s.jsx)(c.Z,{onClick:()=>q.items.some(e=>e.id===N.id)?et(N.id):ee(N),"aria-label":q.items.some(e=>e.id===N.id)?"Remove from wishlist":"Add to wishlist",children:q.items.some(e=>e.id===N.id)?(0,s.jsx)(R.Z,{color:"secondary"}):(0,s.jsx)(T.Z,{})})})]}),N.reviews&&N.reviews.length>0&&(0,s.jsxs)(o.Z,{mt:2,children:[(0,s.jsx)(r.Z,{variant:"subtitle1",children:"Reviews:"}),N.reviews.map((e,t)=>(0,s.jsxs)(o.Z,{mt:1,children:[(0,s.jsxs)(r.Z,{variant:"body2",children:[(0,s.jsx)("strong",{children:e.user}),": ",e.comment]}),(0,s.jsx)(p.Z,{name:"read-only",value:e.rating,readOnly:!0,size:"small"})]},t))]}),(0,s.jsxs)(o.Z,{mt:2,children:[(0,s.jsx)(r.Z,{variant:"subtitle1",children:"Add a Review:"}),(0,s.jsx)(g.Z,{label:"User",value:z.user,onChange:e=>ei("user",e.target.value),fullWidth:!0,margin:"dense"}),(0,s.jsx)(g.Z,{label:"Comment",value:z.comment,onChange:e=>ei("comment",e.target.value),fullWidth:!0,margin:"dense"}),(0,s.jsx)(p.Z,{name:"rating",value:z.rating,onChange:(e,t)=>ei("rating",t||0),"aria-labelledby":"rating"}),(0,s.jsx)(Z.Z,{variant:"outlined",color:"primary",onClick:()=>{if(!N)return;let e={...z,rating:Number(z.rating)};M(t=>t?{...t,reviews:[...t.reviews||[],e]}:null),U("Review added for ".concat(N.name)),$("success"),W(!0),K({user:"",comment:"",rating:0})},disabled:!z.user||!z.comment||!z.rating,sx:{mt:1},"aria-label":"Submit review",children:"Submit Review"})]})]})]}),(0,s.jsx)(y.ZP,{anchor:"right",open:X,onClose:es,"aria-labelledby":"shopping-basket",children:(0,s.jsxs)(o.Z,{sx:{width:350,padding:"1rem"},children:[(0,s.jsx)(r.Z,{variant:"h6",gutterBottom:!0,id:"shopping-basket",children:"Shopping Basket"}),(0,s.jsx)(b.Z,{children:0===i.items.length?(0,s.jsx)(r.Z,{variant:"body1",color:"text.secondary",children:"Your basket is empty"}):i.items.map(e=>(0,s.jsxs)(v.ZP,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(F(),{src:e.images[0],alt:e.name,width:100,height:100,objectFit:"cover"}),(0,s.jsx)(k.Z,{primary:(0,s.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,s.jsx)(c.Z,{onClick:()=>en(e.id,e.quantity-1),"aria-label":"Decrease quantity",children:(0,s.jsx)(E.Z,{})}),(0,s.jsx)(r.Z,{variant:"body1",sx:{mx:1},children:e.quantity}),(0,s.jsx)(c.Z,{onClick:()=>en(e.id,e.quantity+1),"aria-label":"Increase quantity",children:(0,s.jsx)(_.Z,{})})]}),secondary:"$".concat((e.price*e.quantity).toFixed(2))}),(0,s.jsx)(d.Z,{title:"Remove item",children:(0,s.jsx)(c.Z,{edge:"end","aria-label":"delete",onClick:()=>B({type:"REMOVE_FROM_BASKET",id:e.id}),children:(0,s.jsx)(A.Z,{})})})]},e.id))}),(0,s.jsx)(w.Z,{}),(0,s.jsxs)(o.Z,{sx:{padding:"1rem"},children:[(0,s.jsxs)(r.Z,{variant:"h6",children:["Total: $",ea.toFixed(2)]}),i.items.length>0&&(0,s.jsx)(Z.Z,{variant:"contained",color:"primary",onClick:()=>{let t=i.items.some(e=>"physical"===e.type);t?e.push("/checkout/shipping"):e.push("/checkout/payment")},sx:{mt:2},children:"Proceed to Checkout"})]})]})}),(0,s.jsx)(f.Z,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:H,autoHideDuration:3e3,onClose:()=>W(!1),children:(0,s.jsx)(S.Z,{onClose:()=>W(!1),severity:V,children:L})})]}):(0,s.jsx)(r.Z,{children:"Loading..."})}}},function(e){e.O(0,[903,260,454,196,600,774,888,179],function(){return e(e.s=9573)}),_N_E=e.O()}]);